# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n = 20
p = 2
k = 2
B = matrix(1,nrow=k,ncol=p)
B = matrix(1,nrow=k,ncol=p)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n = 20
p = 2
k = 2
B = matrix(1,nrow=k,ncol=p)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
U = diag(1, n)
V = diag(1, p)
V[-which(V==diag(V))] = .9
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*p),nrow=n,ncol=p)
Y = M + L%*%E%*%R
Y
plot(Y)
V[-which(V==diag(V))] = 0
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*p),nrow=n,ncol=p)
Y = M + L%*%E%*%R
plot(Y)
V[-which(V==diag(V))] = 0.9
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*p),nrow=n,ncol=p)
Y = M + L%*%E%*%R
plot(Y)
B
X
# generate matrix-variate error term E
model_data <- list(n=n,p=p,k=k,y=Y,X=X)
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
library(cmdstanr)
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .99,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
samples$summary("B")
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
rstan:::rstudio_stanc("matrix_normal_infer.stan")
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
samples$summary("B")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("matrix_normal_infer.stan")
rstan:::rstudio_stanc("matrix_normal_infer.stan")
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
# generate matrix-variate error term E
model_data <- list(n=n,p=p,k=k,y=Y,x=X)
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
samples$summary("B")
X
p = 5
k = 2
B = matrix(1,nrow=k,ncol=p)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n = 20
p = 5
k = 2
B = matrix(1,nrow=k,ncol=p)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
dim(X)
B = matrix(1,nrow=p,ncol=p)
B
B = matrix(1,nrow=p,ncol=k)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
B
B = matrix(1,nrow=p,ncol=k)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
U = diag(1, n)
V = diag(1, p)
V[-which(V==diag(V))] = 0.9
X
M
plot(y)
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*p),nrow=n,ncol=p)
Y = M + L%*%E%*%R
B = matrix(1,nrow=p,ncol=k)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
U = diag(1, n)
V = diag(1, p)
k = 2
B = matrix(1,nrow=p,ncol=k)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
U = diag(1, n)
V = diag(1, p)
V[-which(V==diag(V))] = 0.9
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*p),nrow=n,ncol=p)
Y = M + L%*%E%*%R
E = matrix(rnorm(n*k),nrow=n,ncol=k)
Y = M + L%*%E%*%R
E = matrix(rnorm(n*k,0,1),nrow=n,ncol=k)
Y = M + L%*%E%*%R
dim(E)
dim(R)
dim(U)
dim(U)
dim(V)
dim(E)
dim(L)
dim(R)
dim(E)
V = diag(1, k)
V[-which(V==diag(V))] = 0.9
L = chol(U)
R = chol(V)
E = matrix(rnorm(n*k,0,1),nrow=n,ncol=k)
Y = M + L%*%E%*%R
plot(Y)
Y
cor2cov <- function(R, S) {
sweep(sweep(R, 1, S, "*"), 2, S, "*")
}
V=cor2cov(V,diag(V))
U=cor2cov(U,diag(U))
U
V
# generate matrix-variate error term E
model_data <- list(n=n,p=p,k=k,y=Y,x=X)
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("matrix_normal_infer.stan")
file <- file.path("matrix_normal_infer.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
samples$summary("B")
samples$summary()
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
fit = compiled$optimize(data = model_data)
D = kronecker(U,V)
DW
D
dim(D)
diag(1,n)
D = kronecker(X,diag(1,n))
D
dim(D)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
setwd("~/Desktop/Emulators")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n = 5
p =3
k = 2
B = matrix(1,nrow=p,ncol=k)
X = matrix(runif(n*p),nrow=n,ncol=p)
M = X%*%B
U = diag(1, n)
V = diag(1, k)
V[-which(V==diag(V))] = 0.9
D = kronecker(X,diag(1,n))
B = rbinom(p*q,prob = .9)
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n=100;p=3,q=2
X = runif(n*p)
B = rbinom(p*q,prob = .9)
p*q
p
q
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n=100;p=3;q=2
q
X = runif(n*p)
B = rbinom(p*q,prob = .9)
B = rbinom(n=p*q,size=p*q,prob = .9)
B
B = rbinom(n=p*q,size=1,prob = .9)
B
B = matrix(rbinom(n=p*q,size=1,prob = .9),n,p)
B
B = matrix(rbinom(n=n*p,size=1,prob = .9),n,p)
B
B = matrix(rbinom(n=n*p,size=1,prob = .5),n,p)
X
dim(X)
X = matrix(runif(n*p),n,q)
dim(X)
dim(B)
X = matrix(runif(n*p),n,p)
R = matrix(rnorm(n*q,0,1),n,p)
R = matrix(rnorm(n*q,0,1),n,q)
Y = X%*%B + R
X%*%B
dim(X)
dim(B)
B = matrix(rbinom(n=n*p,size=1,prob = .5),p,q)
B = matrix(rbinom(n=p*q,size=1,prob = .5),p,q)
R = matrix(rnorm(n*q,0,1),n,q)
Y = X%*%B + R
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
n=100;p=2;q=2
X = matrix(runif(n*p),n,p)
B = matrix(rbinom(n=p*q,size=1,prob = .5),p,q)
R = matrix(rnorm(n*q,0,1),n,q)
Y = X%*%B + R
plot9Y
plot(Y)
# simulate fake data by generating covariate matrix X = runif
# vector[p] x[n];
# vector[k] y[n];
# }
# parameters {
#   matrix[k, p] beta;
#   cov_matrix[k] Sigma;
# }
library(matrixNormal)
R = rmatnorm(2,mu = X%*%B, diag(1,n), .5*diag(1,p)))
R = rmatnorm(2,mu = X%*%B, diag(1,n), .5*diag(1,p))
R = rmatnorm(2,M = X%*%B, diag(1,n), .5*diag(1,p))
R
dim(R)
Y = X%*%B + R
plot(Y)
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
D = kronecker(X,diag(1, n));
D
dim(D)
dim(X)
dim(D)
c(Y)
D = kronecker(X,diag(1, p));
dim(D)
y=c(Y)
length(y)
D = kronecker(X,diag(1, q));
D
dim(D)
D = kronecker(X,diag(1, p));
dim(D)
n=100;p=3;q=2
X = matrix(runif(n*p),n,p)
B = matrix(rbinom(n=p*q,size=1,prob = .5), p,q)
R = rmatnorm(2,M = X%*%B, diag(1,n), .5*diag(1,p))
Y = X%*%B + R
y=c(Y)
n=100;p=3;q=2
X = matrix(runif(n*p),n,p)
B = matrix(rbinom(n=p*q,size=1,prob = .5), p,q)
R = rmatnorm(2,M = X%*%B, diag(1,n), .5*diag(1,p))
X%*%B
dim(B)
dim(X)
R = rmatnorm(2,M = X%*%B, diag(1,n), .5*diag(1,q))
Y = X%*%B + R
y=c(Y)
length(y)
D = kronecker(X,diag(1, p));
dim(D)
D = kronecker(X,diag(1, q));
dim(D)
c(B)
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
rstan:::rstudio_stanc("~/Documents/vech_MN.stan")
# generate matrix-variate error term E
model_data <- list(n=n,p=p,q=q,y=y,D=D)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
rstan:::rstudio_stanc("vech_MN.stan")
rstan:::rstudio_stanc("vech_MN.stan")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
model_data
rstan:::rstudio_stanc("vech_MN.stan")
# generate matrix-variate error term E
model_data <- list(n=n,p=p,q=q,y=y,D=D)
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
setwd("~/Desktop/Emulators")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
rstan:::rstudio_stanc("vech_MN.stan")
rstan:::rstudio_stanc("vech_MN.stan")
file <- file.path("vech_MN.stan")
compiled <- cmdstan_model(file)
samples <- compiled$sample(data = model_data,seed=123,
max_treedepth = 10,adapt_delta = .8,
chains = 4,
iter_warmup = 500,
iter_sampling = 500,
refresh = 100, parallel_chains = 4)
rstan:::rstudio_stanc("vech_MN.stan")
